# สรุปเนื้อหาเกี่ยวกับ Kubernetes

## บทที่ 1: การอัปเดต Pods ใน Deployment

ในส่วนสุดท้าย เราได้อัปเดตภาพหลายบรรทัดและส่งผลลัพธ์ไปยัง Docker Hub ตอนนี้เราจะเข้าสู่ขั้นตอนที่สาม ซึ่งคือการทำให้ Deployment ของเราสร้างใหม่หรืออัปเดต Pods ทั้งหมดด้วยเวอร์ชันล่าสุดของภาพที่เราสร้างขึ้น

### ความท้าทายในการอัปเดต Pods

การทำให้ Deployment อัปเดต Pods ด้วยเวอร์ชันล่าสุดของภาพไม่ใช่เรื่องง่าย เนื่องจากไม่มีวิธีการที่ชัดเจนในการบอกให้ Deployment ใช้เวอร์ชันล่าสุดของภาพที่อัปโหลดไปแล้ว

1. **ปัญหาที่เกิดขึ้น**:
   - การส่งการอัปเดตไฟล์ Deployment โดยไม่เปลี่ยนแปลงไฟล์จะทำให้คำสั่ง `kubectl apply` ปฏิเสธการอัปเดต เพราะไม่มีการเปลี่ยนแปลงในไฟล์
   - หากไม่มีการเปลี่ยนแปลงในไฟล์ Kubernetes จะไม่ตรวจสอบเวอร์ชันใหม่ของภาพที่อัปโหลดไป

### วิธีแก้ปัญหาที่เป็นไปได้

มีสามวิธีที่เราสามารถใช้ในการอัปเดต Pods ด้วยเวอร์ชันล่าสุดของภาพ:

1. **การลบ Pods ด้วยตนเอง**:
   - ลบ Pods ที่จัดการโดย Deployment ด้วยตนเอง เมื่อ Pod ถูกลบ Deployment จะพยายามสร้าง Pod ใหม่โดยอัตโนมัติ
   - **ข้อเสีย**: อาจเกิดปัญหาในสภาพแวดล้อมการผลิต เช่น การลบ Pods ผิด และทำให้ผู้ใช้ไม่สามารถเข้าถึงแอปพลิเคชันได้ชั่วคราว

2. **การตั้งค่าเวอร์ชันใน Docker Images**:
   - การตั้งค่าเวอร์ชันของภาพเมื่อสร้างภาพใหม่ เช่น `v1`, `v2` และระบุเวอร์ชันนี้ในไฟล์ config
   - **ข้อเสีย**: เพิ่มขั้นตอนในการตั้งค่าและอาจเกิดความผิดพลาดเมื่อจำเป็นต้องใส่เวอร์ชันในทั้งสองที่ (สร้างภาพและไฟล์ config)

3. **การใช้คำสั่ง Imperative**:
   - ใช้คำสั่ง Imperative เพื่ออัปเดตเวอร์ชันของภาพที่ Deployment ควรใช้ โดยไม่ต้องเปลี่ยนแปลงไฟล์ config
   - **ข้อดี**: แก้ปัญหาได้เร็ว แต่ทำให้ไฟล์ config ไม่ตรงกับสถานะของ cluster

### สรุป

ทั้งสามวิธีมีข้อดีและข้อเสียที่ชัดเจน โดยเฉพาะวิธีแรกที่มีความเสี่ยงสูงที่สุด วิธีที่สามเป็นวิธีที่ใช้ได้ แต่ไม่ใช่วิธีที่ดีที่สุด การอัปเดต Pods ด้วยเวอร์ชันล่าสุดของภาพใน Kubernetes เป็นเรื่องที่ท้าทาย แต่เรายังมีวิธีที่สามารถใช้ได้ในสถานการณ์ที่ไม่ดีเหล่านี้

---
